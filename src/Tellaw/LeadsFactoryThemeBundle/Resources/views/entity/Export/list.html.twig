{# src/Acme/BlogBundle/Resources/views/Blog/index.html.twig #}
{% extends 'TellawLeadsFactoryThemeBundle::base.html.twig' %}
{% block body %}


    <div class="col-md-12">
        <div class="heading-sec" id="intro6">
            <h1>Administration <i>des exports</i></h1>
        </div>
    </div>

    <div class="col-md-8">
        <h3 class="custom-heading">Exports programmés:</h3>
        <div class="">
            <div class="streaming-tables">
                <span id="found" class="label label-info"></span>
                <table id="stream_table" class='table table-striped table-bordered'>
                    <thead>
                    <tr>
                        <th>Id</th>
                        <th>Formulaire</th>
                        <th>Type</th>
                        <th>Planifié le</th>
                        <th>Exécuté le</th>
                        <th>Lead_Id</th>
                        <th>Méthode</th>
                        <th>Status</th>
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
                <div id="summary">
                    <div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% raw %}
    <script id="template" type="text/html">
        <tr>
            <td>{{record.identifiant}}</td>
            <td>{{record.formulaire}}</td>
            <td>{{record.type}}</td>
            <td>{{{record.planifie}}}</td>
            <td>{{{record.execute}}}</td>
            <td>{{{record.leadsid}}}</td>
            <td>{{{record.methode}}}</td>
            <td>{{{record.status}}}</td>
        </tr>
    </script>
    {% endraw %}

    <script type="text/javascript">


        var template = Mustache.compile($.trim($("#template").html()));

        var view = function(record, index){
            return template({record: record, index: index});
        };

        var datas = [
            {% for job in jobs %}
            {   identifiant: '{{ job.id }}',
                formulaire: '{{ job.form.name }}',
                type: '{{ job.form.formType }}',
                planifie: '{{ job.scheduledAt.date }}',
                execute: '{% if job.executedAt != null %}{{ job.executedAt.date }}{% endif %}',
                leadsid: '{{ job.lead.id }}',
                methode: '{{ job.method }}',
                status: '{{ job.status }}'
            }{% if loop.last==false %},{% endif %}
            {% endfor %}
        ];

        var options = {
            view: view,                  //View function to render table rows.
            fetch_data_limit: 500,       //Streaming data in batch of 500
            pagination: {span: 5, next_text: 'Suivant &rarr;', prev_text: '&larr; Précédent'}
        }

        var st = StreamTable('#stream_table', options, datas);
    </script>


    <div class="col-md-4">

        <h3 class="custom-heading">Actions:</h3>

        <div class="btn-group btn-group-justified">
            <a class="btn pink" href="{{ path ('_entity_leads_export') }}">Exporter maintenant</a>
        </div>

    </div>

    <div class="col-md-4">

        <h3 class="custom-heading">Information:</h3>

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi at semper arcu. Nulla lobortis tempus convallis. Curabitur pharetra ipsum sit amet rutrum aliquam. Aliquam gravida metus urna, consectetur consequat eros molestie eu. Etiam porta facilisis vulputate. Sed non sodales nisi. Nulla convallis mauris et libero hendrerit, sed fringilla turpis gravida. Phasellus ultricies orci tortor, sed rhoncus dui imperdiet vitae. Nam molestie justo eu blandit ultricies. Proin quis rutrum lorem. Curabitur tortor turpis, pulvinar a purus vel, rhoncus rhoncus ex. Integer hendrerit imperdiet sodales.

            Pellentesque a varius ex. Duis nec magna id ligula luctus vehicula nec ut urna. Nullam odio mauris, tincidunt ut viverra eget, ornare in ex. Nulla facilisi. Sed venenatis finibus tincidunt. Nulla vitae neque et sapien euismod venenatis quis vel leo. Sed vitae dui vel tortor posuere vehicula.
        </p>

    </div>


{% endblock %}

{% block javascript %}

{% endblock %}