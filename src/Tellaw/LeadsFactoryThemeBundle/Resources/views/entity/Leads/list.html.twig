{# src/Acme/BlogBundle/Resources/views/Blog/index.html.twig #}
{% extends 'TellawLeadsFactoryThemeBundle::base.html.twig' %}
{% block body %}

    <div class="col-md-12">
        <div class="heading-sec" id="intro6">
            <h1>Administration <i>des leads</i></h1>
        </div>
    </div>

    <div class="col-md-8">
        <h3 class="custom-heading">Leads enregistrés:</h3>
        <div style="clear:both"></div>
        <div class="">
            <div class="streaming-tables">
                <div class="progress progress-striped active">
                    <div id="record_count" class="progress-bar progress-bar-success pink large-progress" style="width: 0%">0</div>
                </div>
                <span id="found" class="label label-info"></span>
                <table id="stream_table" class='table table-striped table-bordered'>
                    <thead>
                    <tr>
                        <th>Identifiant</th>
                        <th>Lastname</th>
                        <th>Firstname</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
                <div id="summary">
                    <div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% raw %}
    <script id="template" type="text/html">
        <tr>
            <td>{{record.identifiant}}</td>
            <td>{{record.firstname}}</td>
            <td>{{record.lastname}}</td>
            <td>{{record.status}}</td>
            <td>{{{record.action}}}</td>
        </tr>
    </script>
    {% endraw %}


        <script type="text/javascript">

        var $summary = $('#summary');
        var $found = $('#found');
        var $record_count = $('#record_count');
        var template = Mustache.compile($.trim($("#template").html()));
        var view = function(record, index){
            return template({record: record, index: index});
        };

        var callbacks = {
            pagination: function(summary){
                if ($.trim($('#st_search').val()).length > 0){
                    $found.text('Found : '+ summary.total).show();
                }else{
                    $found.hide();
                }
                $summary.text( summary.from + ' à '+ summary.to +' de '+ summary.total +' enregistrements');
            },
            after_add: function(){

                var percent = this.data.length*100/2000;
                $record_count.text(percent + '%').attr('style', 'width:' + percent + '%');

                //Only for example: Stop ajax streaming beacause from localfile data size never going to empty.
                if (this.data.length == 2000){
                    this.stopStreaming();
                    $('.example .progress').removeClass('active').hide();
                }

            }
        }

        var st = StreamTable('#stream_table', {
            callbacks: callbacks,
            per_page: 10,
            view: view,
            data_url: '{{ path ('_utils_streamtables_leads') }}',
            stream_after: 0,
            fetch_data_limit: 1000
        }, []);

    </script>

    <div class="col-md-4">

        <h3 class="custom-heading">Informations:</h3>

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi at semper arcu. Nulla lobortis tempus convallis. Curabitur pharetra ipsum sit amet rutrum aliquam. Aliquam gravida metus urna, consectetur consequat eros molestie eu. Etiam porta facilisis vulputate. Sed non sodales nisi. Nulla convallis mauris et libero hendrerit, sed fringilla turpis gravida. Phasellus ultricies orci tortor, sed rhoncus dui imperdiet vitae. Nam molestie justo eu blandit ultricies. Proin quis rutrum lorem. Curabitur tortor turpis, pulvinar a purus vel, rhoncus rhoncus ex. Integer hendrerit imperdiet sodales.

            Pellentesque a varius ex. Duis nec magna id ligula luctus vehicula nec ut urna. Nullam odio mauris, tincidunt ut viverra eget, ornare in ex. Nulla facilisi. Sed venenatis finibus tincidunt. Nulla vitae neque et sapien euismod venenatis quis vel leo. Sed vitae dui vel tortor posuere vehicula.
        </p>

    </div>

{% endblock %}
{% block javascript %}

{% endblock %}